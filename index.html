<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

<title>ADHD Reader</title>

<link rel="stylesheet" href="styles.css">
<link href="data:image/jpeg;base64,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" rel="icon" type="image/x-icon" />

</head>
<body>

<div id="controls">
    <textarea id="textInput" placeholder="Paste your text here..."></textarea>
    <button id="playBtn">▶ Play</button>
    <button id="speedBtn">⚡</button>
    <div id="sliderContainer">
        <span id="wpmLabel">250 WPM</span>
        <input type="range" id="wpmSlider" min="100" max="600" step="25" value="250">
    </div>
</div>

<div id="reader">
    <div id="wordDisplay" class="word"></div>
</div>


<script>
let words = [];
let index = 0;
let timer = null;
let wpm = 300;
let playing = false;

const textInput = document.getElementById("textInput");
const playBtn = document.getElementById("playBtn");
const speedBtn = document.getElementById("speedBtn");
const sliderContainer = document.getElementById("sliderContainer");
const wpmSlider = document.getElementById("wpmSlider");
const wpmLabel = document.getElementById("wpmLabel");
const reader = document.getElementById("reader");
const wordDisplay = document.getElementById("wordDisplay");
const controls = document.getElementById("controls");

/* ---------- ORP ---------- */
function getORPIndex(word) {
    const len = word.length;
    if (len <= 2) return 0;
    if (len <= 5) return 1;
    if (len <= 9) return 2;
    return 2;
}

function renderWord(rawWord) {
    let word = rawWord;
    let hasDot = false;

    if (word.endsWith(".")) {
        hasDot = true;
        word = word.slice(0, -1);
    }

    const i = getORPIndex(word);
    const before = word.slice(0, i);
    const orp = word[i] || "";
    const after = word.slice(i + 1);

    const dot = hasDot
        ? `<span style="color: cyan;">.</span>`
        : "";

    wordDisplay.innerHTML =
        `<span>${before}</span>` +
        `<span class="orp">${orp}</span>` +
        `<span>${after}</span>` +
        dot;
}

/* ---------- TIMING ---------- */
function getWordDelay(word) {
    let effectiveWpm = wpm;
    if (word.length > 6) effectiveWpm = Math.round(wpm * 0.8);

    let delay = 60000 / effectiveWpm;

    if (word.endsWith(".")) delay += 400;

    return delay;
}

function playNextWord() {
    if (!playing) return;

    if (index >= words.length) {
        stopReading();
        return;
    }

    const word = words[index];
    renderWord(word);
    index++;

    timer = setTimeout(playNextWord, getWordDelay(word));
}

/* ---------- READER CONTROL ---------- */
function startReading() {
    text = textInput.value.trim();
    text = ". " + text;

    words = text.split(/\s+/);
    if (!words.length) return;

    index = 0;
    playing = true;

    reader.style.display = "flex";
    controls.style.display = "none";
    reader.classList.remove("paused");

    playNextWord();
}

function stopReading() {
    clearTimeout(timer);
    timer = null;
    playing = false;

    reader.style.display = "none";
    controls.style.display = "flex";
    reader.classList.remove("paused");
}

/* ---------- UI ---------- */
playBtn.onclick = startReading;

speedBtn.onclick = () => {
    sliderContainer.style.display =
        sliderContainer.style.display === "flex" ? "none" : "flex";
};

wpmSlider.oninput = () => {
    wpm = Number(wpmSlider.value);
    wpmLabel.textContent = `${wpm} WPM`;
};

wpmLabel.textContent = `${wpm} WPM`;

/* ---------- TEXTAREA AUTO-GROW ---------- */
function autoGrow(textarea) {
    textarea.style.height = "auto";
    textarea.style.height = textarea.scrollHeight + "px";
}

textInput.addEventListener("input", () => autoGrow(textInput));

/* ---------- KEYBOARD ---------- */
document.addEventListener("keydown", (e) => {
    const readerActive = reader.style.display === "flex";

    if (e.code === "Escape" && readerActive) {
        e.preventDefault();
        stopReading();
        return;
    }

    if (e.code === "Space" && readerActive) {
        e.preventDefault();

        if (playing) {
            clearTimeout(timer);
            timer = null;
            playing = false;
            reader.classList.add("paused");
        } else {
            playing = true;
            reader.classList.remove("paused");
            playNextWord();
        }
        return;
    }

    if (readerActive && !playing) {
        if (e.code === "ArrowLeft" && index > 0) {
            e.preventDefault();
            index--;
            renderWord(words[index]);
        }

        if (e.code === "ArrowRight" && index < words.length) {
            e.preventDefault();
            renderWord(words[index]);
            index++;
        }
    }
});

/* ---------- TOUCH CONTROLS (3×3 GRID) ---------- */
reader.addEventListener("touchstart", (e) => {
    if (reader.style.display !== "flex") return;

    const touch = e.touches[0];
    const x = touch.clientX / window.innerWidth;
    const y = touch.clientY / window.innerHeight;

    e.preventDefault();

    // TOP LEFT or TOP RIGHT → exit
    if (y < 0.33 && (x < 0.33 || x > 0.66)) {
        stopReading();
        return;
    }

    // BOTTOM LEFT → previous word
    if (y > 0.66 && x < 0.33) {
        if (index > 1) {
            index -= 2;
            renderWord(words[index]);
        }
        return;
    }

    // BOTTOM RIGHT → next word
    if (y > 0.66 && x > 0.66) {
        if (index < words.length) {
            renderWord(words[index]);
            index++;
        }
        return;
    }

    // ANYWHERE ELSE → pause / resume
    if (playing) {
        clearTimeout(timer);
        playing = false;
        reader.classList.add("paused");
    } else {
        playing = true;
        reader.classList.remove("paused");
        playNextWord();
    }
}, { passive: false });
</script>



</body>
</html>
